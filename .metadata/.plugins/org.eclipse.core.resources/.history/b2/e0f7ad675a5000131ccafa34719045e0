/*
 * Server.cpp
 *
 *  Created on: Nov 18, 2013
 *      Author: gustaf
 */

#include "server.h"

sent_txt
using System.Text;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Net.Sockets;
using System.Windows.Forms;

public class Server {
public static void Main() {
	try {
		IPAddress ipAd = IPAddress.Parse("192.168.43.1");
		// use local m/c IP address, and

		// use the same in the client


		/* Initializes the Listener */
		TcpListener myList=new TcpListener(ipAd,4444);

		/* Start Listeneting at the specified port */
		myList.Start();

		Console.WriteLine("The server is running at port 4444...");
		Console.WriteLine("The local End point is  :" +
				myList.LocalEndpoint );
		Console.WriteLine("Waiting for a connection.....");
		m:
		Socket s=myList.AcceptSocket();
		Console.WriteLine("Connection accepted from " + s.RemoteEndPoint);

		byte[] b=new byte[100];
		int k=s.Receive(b);

		char cc = ' ';
		string test = null;
		Console.WriteLine("Recieved...");
		for (int i = 0; i < k-1; i++)
		{
			Console.Write(Convert.ToChar(b[i]));
			cc = Convert.ToChar(b[i]);
			test += cc.ToString();
		}

		switch (test)
		{
		case "1":
		break;


		}

		ASCIIEncoding asen=new ASCIIEncoding();
		s.Send(asen.GetBytes("The string was recieved by the server."));
		Console.WriteLine("\nSent Acknowledgement");


		/* clean up */
		goto m;
		s.Close();
		myList.Stop();
		Console.ReadLine();

	}
	catch (Exception e) {
		Console.WriteLine("Error..... " + e.StackTrace);
	}
}

}
